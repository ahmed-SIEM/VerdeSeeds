<div class="app-wrapper">
  <div class="container-xl mt-4">
    <h1 class="app-page-title">üìÖ {{ isEditMode ? 'Modifier' : 'Cr√©er' }} une r√©servation</h1>

    <form [formGroup]="reservationForm" (ngSubmit)="onSubmit()" class="mt-4">
      <!-- S√©lection ou Affichage de l'Article -->
      <div class="mb-3">
        <label for="articleId" class="form-label">Article</label>
        <select *ngIf="!isEditMode" class="form-select" id="articleId" (change)="onArticleSelect($event)">
          <option value="">S√©lectionner un article</option>
          <option *ngFor="let article of articles" [value]="article.id">
            {{ article.title }}
          </option>
        </select>
        <div *ngIf="isEditMode" class="form-control readonly-field">
          {{ selectedArticleTitle || 'Article inconnu' }}
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="startDatetime" class="form-label">Date de d√©but</label>
          <input type="datetime-local" class="form-control" id="startDatetime" formControlName="startDatetime" 
            [class.is-invalid]="(reservationForm.get('startDatetime')?.errors?.['pastDate'] || reservationForm.errors?.['dateRange']) && reservationForm.get('startDatetime')?.touched" />
          <div class="invalid-feedback" *ngIf="reservationForm.get('startDatetime')?.errors?.['pastDate']">
            La date de d√©but ne peut pas √™tre dans le pass√©
          </div>
        </div>
        <div class="col-md-6 mb-3">
          <label for="endDatetime" class="form-label">Date de fin</label>
          <input type="datetime-local" class="form-control" id="endDatetime" formControlName="endDatetime"
            [class.is-invalid]="reservationForm.errors?.['dateRange'] && reservationForm.get('endDatetime')?.touched" />
          <div class="invalid-feedback" *ngIf="reservationForm.errors?.['dateRange']">
            La date de fin doit √™tre post√©rieure √† la date de d√©but
          </div>
        </div>
      </div>

      <!-- Prix Total -->
      <div class="mb-3">
        <label class="form-label">Prix total</label>
        <div class="input-group">
          <div class="form-control readonly-field">
            {{ getTotalPrice() }}
          </div>
          <span class="input-group-text">‚Ç¨</span>
          <small class="text-muted ms-2">Calcul√© automatiquement</small>
        </div>
      </div>

      <!-- Statut -->
      <div class="mb-3">
        <label for="status" class="form-label">Statut</label>
        <select class="form-select" id="status" formControlName="status">
          <option value="PENDING">En attente</option>
          <option value="CONFIRMED">Confirm√©e</option>
          <option value="CANCELLED">Annul√©e</option>
        </select>
      </div>

      <!-- Boutons -->
      <div class="d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-secondary" (click)="navigateToReservations()">
          Annuler
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="!isFormValid()">
          {{ isEditMode ? 'Mettre √† jour' : 'Cr√©er' }}
        </button>
      </div>
    </form>
  </div>
</div>
