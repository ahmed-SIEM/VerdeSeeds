<div class="row">
  <div class="col-12 col-sm-6 col-lg-4 mb-4" *ngFor="let formation of formations">
    <div class="card shadow-sm h-100">
      <!-- Image -->
      <img
        [src]="getImagePath(formation.photoPath)"
        class="card-img-top"
        alt="formation image"
        *ngIf="formation.photoPath; else defaultImg"
      />
      <ng-template #defaultImg>
        <img
          src="assets/frontoffice/img/bg-img/placeholder.png"
          class="card-img-top"
          alt="Default image"
        />
      </ng-template>

      <!-- Infos principales -->
      <div class="card-body text-center">
        <h6 class="text-muted">{{ formation.typeFormation }}</h6>
        <h5 class="text-success text-truncate" title="{{ formation.nom }}">{{ formation.nom }}</h5>
        <p class="mb-1">📍 <span class="text-secondary">{{ formation.lieu }}</span></p>
        <p>📅 Du {{ formation.dateDebut | date: 'dd/MM/yyyy' }} au {{ formation.dateFin | date: 'dd/MM/yyyy' }}</p>

        <!-- ✅ Certification -->
        <p *ngIf="formation.certification">
          🏅 <strong>Formation Certifiante</strong><br />
          ✅ <small>Note minimale : {{ formation.noteMinPourCertificat }}/20</small>
        </p>
        <p *ngIf="!formation.certification">
          ❌ <em>Non certifiante</em>
        </p>

        <!-- ✅ Capacité -->
        <p>
          👥 <strong>Capacité :</strong> {{ formation.capacity }} personnes
        </p>

        <!-- Boutons -->
        <div class="d-flex justify-content-center gap-2 mt-2 flex-wrap">
          <a
            *ngIf="formation.detailFormation"
            [routerLink]="['/frontoffice/details', formation.idFormation]"
            class="btn btn-outline-success btn-sm"
          >
            👁️ Voir Détails
          </a>
          <button class="btn btn-outline-primary btn-sm">🎓 Participer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Calendrier -->
  <div class="col-12 text-center mt-4">
    <button class="btn btn-success" (click)="showCalendarPopup()">
      📅 Voir le Calendrier
    </button>
  </div>
</div>

<!-- Component du calendrier -->
<app-calendar-popup
  *ngIf="showCalendar"
  [events]="calendarEvents"
  (closePopup)="showCalendar = false">
</app-calendar-popup>
